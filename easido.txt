[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[

                                            拡張属性補完計画「EAs,I do!」

]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]

「EAs,I do!」はASCIIタイプの拡張属性をコマンドラインより操作するツールです。

ASCIIタイプの拡張属性を操作するツールとしては、拙作の NYAOS と eff 、
織華さんの「書きくけコメント」などがあります。しかしながら、これらの
ツールは、バッチファイルから呼び出せないので、複数ファイルへの拡張属性の
設定・複写などには向いていません(て、断言しちゃっていいのかな)。

一方、OS/2 には EAUTIL.EXE という標準コマンドもありますが、これは拡張属性
全てを一括した操作しか出来ず、特定の拡張属性のみで扱うことができません。

そんなわけで、各拡張属性を個別にバッチ操作できる簡単なコマンド
「EAs,I do!」の出番です。パチパチパチ〜。

なお、使用には emx 0.9d FIX03 の DLL が必要です!!!


★ 基本操作 ★


(0) ヘルプ：「easido」
	簡単なヘルプ表示を行います。

(1) 拡張属性のリスト：「easido FILENAME」
	FILENAME のファイルの拡張属性(.SUBJECT,.LONGNAME,.COMMENTS,
	.HISTORY,.KEYPHRASE)の内容一覧を表示します。

(2) 拡張属性の表示：「easido FILENAME EATYPE」(入力リダイレクトしていない時)
                    「easido -p FILENAME EATYPE」
	FILENAME のファイルの拡張属性EATYPE の内容を標準出力へ出力します。
	EATYPE には
		.SUBJECT	(「S」「SUBJECT」でも可)
		.LONGNAME	(「L」「LONGNAME」でも可)
		.COMMENTS	(「C」「COMMENTS」でも可)
		.HISTORY	(「H」「HISTORY」でも可)
		.KEYPHRASES	(「K」「KEYPHRASES」でも可)
	のみを受けつけます。小文字で書いても構いません。各拡張属性の
	意味は、後述で解説しておりますので、そっち読んでください。

(3) 拡張属性の設定：「easido FILENAME EATYPE VALUE」
	FILENAME のファイルの拡張属性 EATYPE に VALUE を設定します。
	EATYPE は (2) と同じですが、１行分しか設定できません。
	.COMMENTS や .HISTORY , .KEYPHRASES などで、複数行設定したい
	場合は、(5) で標準入力経由で行ってください。

(4) 拡張属性の削除：「easido -r FILENAME EATYPE」
	FILENAME のファイルの拡張属性 EATYPE を削除します。
	EATYPE は (2) と同じです。

(5) 拡張属性の設定(標準入力)：「easido -c FILENAME EATYPE < VALUEFILE 」
                              「easido FILENAME EATYPE < VALUEFILE」
                              「COMMAND | easido FILENAME EATYPE」
	標準入力から入力される内容をFILENAMEの拡張属性EATYPE に設定します。
	EATYPE は (2) と同じですが、.LONGNAME , .SUBJECT は元々１行分しか
	記憶できないので、2行目以降は無視されます。
	(注意) 1行も存在しない場合は、その拡張属性を変更しません!!!
	       拡張属性を削除したい場合は -r を使用してください。

(6) 複数型拡張属性に追加：「easido -a FILENAME EATYPE VALUE」
	.COMMENTS,.HISTORY,.KEYPHRASES などの複数型の拡張属性に値 VALUE を
	追加します。


★ 応用操作 ★

「EAs,I do!」は単体で用いるよりも、パイプなどを利用して、他のプログラムと
組み合わせた方が威力を発揮します(どんな威力だ)。


(1) 同じファイル内での別の拡張属性の移動 (.COMMENTS の内容を .SUBJECT へ等)

簡単な例をまず出すと、
	「easido FILENAME c | easido FILENAME s」
とすると、コメントの最初の1行をサブジェクトに複写することができます。
サブジェクトは１行しか記録できませんので、コメントの２行目以降は無視
されるのに注意してください。

NYAOS の foreach・逆クォートや dir と組み合わせれば、複数のファイルでの、
コメント→サブジェクトへの一括した移し替えなんてこともできます。

	foreach i `dir /s /b *.cc`
		easido $i c | easido $i s	← サブジェクトへの複写
		easido -r $i comments		← コメントの削除
	end

というか、こういう使い方の為に作ったようなツールなんですよ。
ワタシ、ずーっと .COMMENTS の1行目だけを、.SUBJECT のように使って
いたもんで…(NYAOS の comment 命令のせいで、そうなった人はさぞ多かろう…)


(2) コメントを使い慣れたエディタで編集

過激派コマンドライン原理主義者の方で、vi(何故vi!?)でじっくりコメントを
書きたい！という人は、こういうバッチファイルを作ってもいいでしょう。
(まぁ vipw とか、crontab の感覚ですね。emacs派の人は vi を emacsclient
 と読み替えてください)
	
	rem --- memo.cmd ---
	easido %1 comments > tmp
	vi tmp
	easido %1 comments < tmp
	del tmp

これだったら、NYAOS で alias にしてもいいですよね。
  alias memo="easido %1 c > tmp && vi tmp && easido %1 c < tmp && del tmp"

GUI の方がよい場合は、こんな凝った方法ではなく、素直に織華さんの「書きくけ
コメント」を用いましょう。


(3) E-mail や News の .SUBJECT を拡張属性に記録する。

他、NetNews や E-Mail の Subject: 行を .SUBJECT 属性のコピーなんつーことも
EAs,I do! を使えば可能です。こうすると、NYAOS の「ls -E」や eff でファイル
名の横に表題が表示されて便利です(とさりげなく宣伝)。

	rem --- NewsTitle.cmd ---
	grep -i "subject: " %1 | easido -c %1 subject

これだと「Subject: 」つー文字も記録されてしまいます。これが気に要らない
場合は REXX で切り貼りするスクリプトを自分で書きましょう。


(4) ファイル名のリネームの履歴を付ける。

あと、名前を変更する際に前の名前を履歴としてとっておくようなこともできます。
バッチファイルなら、
    rem --- RenHist.cmd ---
    easido.exe -a %1 history "rename %1 to %2" &&  rename %1 %2
NYAOS のエイリアスなら、
    alias renhist="easido -a %1 history ""rename %1 to %2"" && ren %1 %2"
となります。これで、
	renhist a.exe b.exe
	renhist b.exe c.exe
と実行すると、c.exe の .HISTORY 属性に
	rename a.exe to b.exe
	rename b.exe to c.exe
と記録されるわけです、はい。記録した履歴は「easido ファイル名 h」で確認
できます。ただし、これワイルドカードには対応しとりませんので、あしからず…


(5) その他

あと、00index.txt から .SUBJECT 属性を生成したり、その逆なんつーのも
ありますね。これは面倒だから、置いときますが、REXX の力を借りれば
簡単でしょう（簡単なら添付しろよ）。


★ 解説しよう ★


拡張属性というと、ほとんど拡張子の代わりだという認識が広まって、
役立たねぇと思われていることが多いのですが、そんなこと無いです。

実際のところは、そのファイルを扱うアプリが想定していないような
情報を任意に付けることが出来るので、かなり便利です。ただ、拡張
属性は、一部のアプリはファイル自身に書き込みを行う時に、安易に
削除してしまうので(あるいはバックアップファイルにとり残されて
しまうとか)、恩恵に預かれにくいのも確かです。

そこで、余り書き込みを行われないファイルに対して積極的に使うのが
得策です。そういうファイルとしては
	・オンラインソフトのアーカイブファイル
	・ディレクトリ
などがありますね。って、それしか無いのか？！ おい！

まぁまぁ(^^;;。しかしながら、オンラインソフトのアーカイブなんて、
無理に 8.3 形式にファイル名を縮めていたりするので、簡単な解説や
入手元の記録などにはもってのこいですよ、はい。

あと、重要な点が一つ。拡張属性には半角カナを使っても何ら問題は
ありません！ 拡張属性は ファイルを他の OS へ持ってゆくときは
ついてゆかないので、遠慮無しに使いましょう(って、そんな習慣は
つけない方がいいのかな)

それから、MP3 ファイルなんて、デコーダーが日本語ファイル名を
ちゃんと表示できない場合がありますよね。そういった時にも…



さて、ファイルには複数の拡張属性を付けることができ、それぞれ名前が
あります。この名前は自由につけることができるのですが、標準で汎用的
に用いることができそうな拡張属性の名前と型も定義されています。ここは、
ぜひその標準拡張属性を活用すべきでしょう。というわけで、以下で EAs,I
do! でサポートしている拡張属性について、簡単な解説をしたいと思います。

「.LONGNAME」
	ファイルのワークプレイスシェルから見える名前を格納します。
	HPFS でないドライブでも、8+3文字以上の名前をつけられるのは
	この属性のおかげです。本来、ファイル名に用いることの出来ない
	文字も使用できるので、HPFS のファイルでも使われることがあります。

	対応アプリ：
		・WorkPlaceShell自体
		・LongName (altair☆さん作：.LONGNAME設定ツール)
		・redlong.cmd (Altair☆さん作：不要な .LONGNAME の削除等)
		・lcp.cmd (宇野さん作：.LONGNAME を参照・記録する拡張cp)
		・書きくけコメント (織華さん作)
		・EAs,I do! (拙作)
		・VFATSYNC (拙作)
		・NYAOS の内蔵 ls  (拙作)


「.SUBJECT」
	１行くらいでおさまる程度の、ファイルの簡単な概略を書きます。
	E-mail や NetNews の Subject: 行を連想するとよいでしょう。
	規格上は 40文字までしか駄目ということですが、実際は250文字程度
	まで大丈夫だそうです。
	
	対応アプリ：
		・プロパティーの「ファイル」タグの３ページ目
		・書きくけコメント(織華さん作)
		・wget-1.5.3.1 (Altair☆さん版：URL を記録してくれます)
		・EAs,I do! (拙作)
		・NYAOS の内蔵 ls , subject コマンド(拙作)
	
「.COMMENTS」
	ファイルの説明・コメントを記します。名前に複数の「S」が付いている
	ことから分かるように、複数行記述することができますので、そこそこ
	詳細な説明も記述できます。

	対応アプリ：
		・プロパティーの「ファイル」タグの３ページ目
		・書きくけコメント(織華さん作)
		・EAs,I do! (拙作)
		・NYAOS の内蔵 ls , comment コマンド
			(拙作：複数行に対応してません)
		・今は亡き NewsTitle.CMD(拙作)

・「.HISTORY」
	ファイルの履歴を記録することができます。したがって、当然、複数行
	の記述ができます。

	対応アプリ：
		・プロパティーの「ファイル」タグの３ページ目
		・書きくけコメント(織華さん作)
		・EAs,I do!(拙作)

・「.KEYPHRASES」
	ファイルの関係するキーワードを登録できます。これも複数定義できます。

	対応アプリ：
		・プロパティーの「ファイル」タグの３ページ目
		・書きくけコメント(織華さん作)
		・EAs,I do!(拙作)

★ エラーコード一覧

	0 … エラーなし。
	1 … 対象のファイルが存在しない。
	2 … 引数の数が０である(説明の表示)
	3 … 引数の数が少なすぎる。
	4 … 引数の数が多すぎる。

	5 … サポートしていない EA のタイプ。
	6 … サポートしていないオプション。
	7 … 単一タイプの EA に追記しようとした。
	8 … EA を書き込むのに失敗した。

★ 拡張属性補完計画 ★

拡張属性を活用したい人々にお薦めのページ

・http://hp.vector.co.jp/authors/VA01468/
	織華さんの「Rexx使いの卵の page」です。GUI による拡張属性操作
	ツール「DrEA」「書きくけコメント」などがあります。

・http://hp.vector.co.jp/authors/VA000199/
	Altair☆さんの「Altar☆'s page」です。取得元のURLを .SUBJECT
	属性に保存してくれる wget や、.LONGNAME操作のツールなどがあります。

・http://hp.vector.co.jp/authors/VA009797/
	ワタシのページです。本ソフトウェア(EAs,I do!)の他、NYAOS も
	拡張属性を支援してます(何だそりゃ)。VFATSYNC もあるでよ〜。

なぜ、みんな「hp.vector.co.jp/authors/」ばかりなんでしょうね、ホント(笑)
拡張属性に魂を魅かれた人々はベクターに集うのかも。



★ 著作権 ★

本ソフトウェアは、葉山 薫が著作権を有しますが、配布・転載・改変について
特に制限を設けません。フリーソフトウェアとして、GNU General Public
License に従って、ご自由にご利用ください。

本ソフトウェアによるバグ・不具合などよって障害・被害が生じても、作者は
一切責任を負いません。なお、バグリポートをいただけましたら、なるべく、
次バージョンにおいて、その不具合を修正するよう努力します。

最新の EAs,I do! は次の URL よりダウンロードできます。
	http://hp.vector.co.jp/authors/VA009797/warp/ell.html#easido
バグリポートはこちらへ
	mailto:iyamatta.hayama@nifty.ne.jp

★ 変更履歴 ★

1.00	(1999.08.15) 初公開
1.01	(1999.08.28)
・-a オプション追加
・オプションがある場合に引数が少ないと、コアダンプしてしまうのを修正
1.02	(2001.04.08)
・ファイルが存在しない場合、エラーを表示するようにした。
・エラーコードを整備した。

サ｜ サ ---- はやま かおる (HAYAMA,Kaoru) ---------
世｜ 千 ★ mailto:iyamatta.hayama@nifty.ne.jp
木山 黒 ♪ http://hp.vector.co.jp/authors/VA009797/
